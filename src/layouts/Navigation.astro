---
const { pathname } = Astro.url;
const base = import.meta.env.BASE_URL;
---
<header class="sticky top-0 z-50 bg-[var(--bg-primary)]/90">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-8">
            <a href={base} class="flex items-center gap-1 font-[Secular_One] text-lg font-semibold tracking-wide">
                <div class="flex items-center justify-center w-6 h-6 rounded-lg bg-[var(--monochrome-text)] text-[var(--monochrome-bg)] text-base font-bold">
                    <span style="font-size:22px; display: block; transform: translateX(0.5px);transform: translateY(0.5px);">O</span>
                </div>
                <span>RWL</span>
            </a>

            <!-- Mobile Menu Button -->
            <button
                id="mobile-menu-button"
                class="lg:hidden text-[var(--text-primary)] hover:text-[var(--text-primary)]/80 transition-colors"
                aria-label="Toggle menu"
            >
                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path class="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    <path class="close-icon hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>

            <!-- Desktop Navigation -->
            <nav class="hidden lg:flex items-center gap-8">


                <!-- Community Dropdown Menu -->
                <div class="relative group">
                    <button class="flex items-center gap-2 text-[var(--text-primary)] hover:text-[var(--text-primary)]/80 transition-colors">
                        <span>Community</span>
                        <svg class="w-4 h-4 transition-transform duration-200 group-hover:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>

                    <!-- Dropdown Content -->
                    <div class="absolute left-0 top-full pt-2 opacity-0 translate-y-2 pointer-events-none group-hover:opacity-100 group-hover:translate-y-0 group-hover:pointer-events-auto transition-all duration-200">
                        <div class="w-64 surface rounded-lg border border-[var(--monochrome-text)]/20 shadow-lg shadow-black/50 backdrop-blur-xl overflow-hidden">
                            <a href={`${base}/coming-soon`} class="block p-4 hover:bg-[var(--monochrome-text)]/5 transition-colors">
                                <div class="font-semibold mb-1" style="color: var(--monochrome-text)">Become a Member</div>
                                <div class="text-sm text-[var(--text-secondary)]">Contribute to the organization</div>
                            </a>
                            <a href={`${base}/coming-soon`} class="block p-4 hover:bg-[var(--monochrome-text)]/5 transition-colors">
                                <div class="font-semibold mb-1" style="color: var(--monochrome-text)">Join the Roundtables</div>
                                <div class="text-sm text-[var(--text-secondary)]">Participate in agenda decisions</div>
                            </a>
                            <a href="https://discord.gg/aFb3PUR5Bz" class="block p-4 hover:bg-[var(--monochrome-text)]/5 transition-colors">
                                <div class="font-semibold mb-1" style="color: var(--monochrome-text)">Discord</div>
                                <div class="text-sm text-[var(--text-secondary)]">Discuss with other members </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Resources Dropdown Menu -->
                <div class="relative group">
                    <button class="flex items-center gap-2 text-[var(--text-primary)] hover:text-[var(--text-primary)]/80 transition-colors">
                        <span>Resources</span>
                        <svg class="w-4 h-4 transition-transform duration-200 group-hover:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>

                    <!-- Dropdown Content -->
                    <div class="absolute left-0 top-full pt-2 opacity-0 translate-y-2 pointer-events-none group-hover:opacity-100 group-hover:translate-y-0 group-hover:pointer-events-auto transition-all duration-200">
                        <div class="w-64 surface rounded-lg border border-[var(--monochrome-text)]/20 shadow-lg shadow-black/50 backdrop-blur-xl overflow-hidden">
                            <a href={`${base}/manifesto`} class="block p-4 hover:bg-[var(--monochrome-text)]/5 transition-colors">
                                <div class="font-semibold mb-1" style="color: var(--monochrome-text)">Manifesto</div>
                                <div class="text-sm text-[var(--text-secondary)]">Our vision for fair music streaming</div>
                            </a>
                            <a href="https://github.com/orgs/beorwl/repositories" class="block p-4 hover:bg-[var(--monochrome-text)]/5 transition-colors">
                                <div class="font-semibold mb-1" style="color: var(--monochrome-text)">Developer Handbook</div>
                                <div class="text-sm text-[var(--text-secondary)]">Help us to build</div>
                            </a>
                        </div>
                    </div>
                </div>


            </nav>
        </div>

        <div class="hidden lg:block">
            <a href={`${base}/coming-soon`} class="btn btn-secondary mr-2">
                For Artists & Labels
            </a>
            <a href={`${base}/coming-soon`} class="btn btn-primary">Download App</a>

        </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="lg:hidden hidden">
        <nav class="px-6 py-4 border-t border-[var(--monochrome-text)]/10 bg-[var(--bg-primary)] space-y-4">


            <div class="py-2">
                <div class="font-medium mb-2 text-[var(--text-primary)]">Community</div>
                <a
                        href="https://discord.gg/beorwl"
                        class="block py-2 pl-4 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors"
                >
                    Verein beitreten
                </a>
                <a
                    href="https://discord.gg/beorwl"
                    class="block py-2 pl-4 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors"
                >
                    Discord
                </a>
            </div>
            <div class="py-2">
                <div class="font-medium mb-2 text-[var(--text-primary)]">Resources</div>
                <a
                    href={`${base}/manifesto`}
                    class="block py-2 pl-4 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors"
                >
                    Manifesto
                </a>
                <a
                    href={`${base}/docs/handbook`}
                    class="block py-2 pl-4 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors"
                >
                    Developer Handbook
                </a>
            </div>
            <div class="pt-2">
                <a href={`${base}/#waitlist`} class="btn btn-primary w-full justify-center">Join Waitlist</a>
            </div>
        </nav>
    </div>
</header>

<script>
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.querySelector('.menu-icon');
    const closeIcon = document.querySelector('.close-icon');

    if (mobileMenuButton && mobileMenu && menuIcon && closeIcon) {
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            menuIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');
        });
    }
</script>

<style>
/* Ensure dropdown stays visible while hovering */
.group:hover .group-hover\:pointer-events-auto {
    pointer-events: auto;
}

/* Add some animation to the chevron */
.group:hover .group-hover\:rotate-180 {
    transform: rotate(180deg);
}

/* Mobile menu animation */
#mobile-menu {
    transition: all 0.3s ease-in-out;
}

/* Active state styles */
.active {
    color: var(--monochrome-text) !important;
}
</style>
