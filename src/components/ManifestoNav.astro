---
const introduction = [
    { id: 'values', title: 'Our Values' },
    { id: 'overview', title: 'Overview' },
];
const problems = [
    { id: 'pyramid-scheme-payout', title: 'Pyramid Scheme Payout' },
    { id: 'maximizing-shareholder-revenue', title: 'Maximizing Shareholder Revenue' },
    { id: 'music-made-for-algorithms', title: 'Music made for Algorithms' },
    { id: 'ai-songs-and-bot-farms', title: 'AI Songs & Bot Farms' },
    { id: 'pay-2-play-playlists', title: 'Pay-2-Play Playlists' }
];
const solutions = [
    { id: 'artist-first', title: 'Artist First' },
    { id: 'stream-2-own', title: 'Stream-2-Own' },
    { id: 'no-ai-policy', title: 'No AI Policy' },
    { id: 'nonprofit', title: 'Nonprofit' },
    { id: 'open-source', title: 'Open Source' },
];
---

<nav class="hidden lg:block fixed left-0 top-0 h-screen w-64 border-r border-[var(--monochrome-text)]/10 bg-[var(--bg-primary)]/95 backdrop-blur-sm overflow-y-auto z-[60]">
    <div class="p-4 pt-6">
        <div class="text-sm font-medium text-[var(--monochrome-text)] uppercase tracking-wider mb-4">
            Introduction
        </div>
        <ul class="space-y-0">
            {introduction.map(section => (
                <li>
                    <a
                        href={`#${section.id}`}
                        class="block py-2 px-3 text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--monochrome-text)]/5 rounded transition-colors"
                    >
                        {section.title}
                    </a>
                </li>
            ))}
        </ul>
        <div class="text-sm font-medium text-[var(--monochrome-text)] uppercase tracking-wider mb-4 mt-4">
            Problems
        </div>
        <ul class="space-y-0">
            {problems.map(section => (
                    <li>
                        <a
                                href={`#${section.id}`}
                                class="block py-2 px-3 text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--monochrome-text)]/5 rounded transition-colors"
                        >
                            {section.title}
                        </a>
                    </li>
            ))}
        </ul>

        <div class="text-sm font-medium text-[var(--monochrome-text)] uppercase tracking-wider mb-4 mt-4">
            Solutions
        </div>
        <ul class="space-y-0">
            {solutions.map(section => (
                    <li>
                        <a
                                href={`#${section.id}`}
                                class="block py-2 px-3 text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--monochrome-text)]/5 rounded transition-colors"
                        >
                            {section.title}
                        </a>
                    </li>
            ))}
        </ul>
    </div>
</nav>

<script>
    // Highlight current section based on scroll position
    const observer = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                const id = entry.target.getAttribute('id');
                const menuItem = document.querySelector(`nav a[href="#${id}"]`);

                if (entry.isIntersecting) {
                    document.querySelectorAll('nav a').forEach(link => {
                        link.classList.remove('bg-[var(--monochrome-text)]/5', 'text-[var(--text-primary)]');
                        link.classList.add('text-[var(--text-secondary)]');
                    });
                    if (menuItem) {
                        menuItem.classList.remove('text-[var(--text-secondary)]');
                        menuItem.classList.add('bg-[var(--monochrome-text)]/5', 'text-[var(--text-primary)]');
                    }
                }
            });
        },
        {
            rootMargin: '-20% 0px -70% 0px',
            threshold: 0.1
        }
    );

    // Track all h2 and h3 elements that have an ID
    document.querySelectorAll('h2[id], h3[id]').forEach((heading) => {
        observer.observe(heading);
    });
</script>
